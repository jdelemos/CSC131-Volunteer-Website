<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel = "stylesheet" href = "/VW/styles.css">
        <title>Sample Event Creation</title>
        <script src="/VW/userpopout.js" defer></script>
        <script src="/VW/login.js" defer></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        handleLoginState();
    });
    </script>
    </head>
<body>
   <header class="header">

        <div class="logo"><a href = "/VW/admin.html"><img src="/VW/images/image3.png" alt=""></div></a>  
        <a href="manage-events"><h1 class="title">Manage Events</h1> </a>
        <a href="create-event"><h1 class="title">Create Event</h1></a>

         <div class="right-items"> 
             <a href="userinfo.html" class="title hidden" id="update"><h1 class="title"></h1></a>
            <h1 class="title hidden" id="signout" onclick="signOut()">Sign Out</h1>
        </div>

        <div class="circle" id="userButton" onclick="checkbutton()">
            <div class="login-icon">
                <img src="/VW/images/user.png" alt="Login">
            </div>
        </div>
    </header>
<div class = "apply-page">
    <h1><br><br></h1>

        <div id="output-container">
            <!-- Content will be printed here -->
        </div>
    <script>
            window.onload=fetchData(); 
            async function fetchData() {
  try {
    const response = await fetch('https://vast-wave-12355-e83778ef23ea.herokuapp.com/events-data');
    
    // Check if the response is not successful (status code in the range 200-299)
    if (!response.ok) {
      throw new Error(`Error: ${response.status} - ${response.statusText}`);
    }

    const contentType = response.headers.get('content-type');
    
    // Check if the response is JSON
    if (contentType && contentType.includes('application/json')) {
      const data = await response.json();
      displayData(data);
    } else {
      throw new Error('Unexpected response format: Not JSON');
    }
  } catch (error) {
    console.error('Error fetching data:', error);
  }
}
    
function displayData(data) {
        const outputContainer = document.getElementById('output-container');
        if (data.length === 0) {
            outputContainer.innerHTML = '<p>No data available.</p>';
        } else {
            let htmlContent = '';
            data.forEach(item => {
                // Wrap each event rectangle in an anchor tag with the appropriate href
                htmlContent += `
                    <a href="javascript:void(0);" class="event-link" onclick="showEventDetails(${item.eventid})">
                        <div class="event-rectangle">
                            <div class="text-wrap">
                                <p class="text"> <b> Event: </b>${item.eventName}</p>
                                <p class="text"> <strong>Description: </strong>${item.description}</p>
                                <p class="text"> <strong>Dates: </strong>${item.startDate} - ${item.endDate}</p>
                                <p class="text"> <strong>Time: </strong>${item.time}</p>
                                <p class="text"> <strong>Location: </strong>${item.location}</p>
                            </div>  
                        </div>
                    </a>`;
            });

            outputContainer.innerHTML = htmlContent;
            checkUserApplications(); // Call after events are loaded
        }
    }

    function showEventDetails(eventId) {
        // Change the page content to display the event ID
        const outputContainer = document.getElementById('output-container');
        outputContainer.innerHTML = `<p>Event ID: ${eventId}</p>`;
    }
    </script>        
</div>
<script src="/VW/scalingfactor.js"></script>

</body>
</html>
